<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>My Garden - Pomodoro Plant</title><link rel="icon" type="image/png" href="assets/flower-img.png"><link rel="stylesheet" href="css/style.css"><link href="https://fonts.googleapis.com/css?family=Pixelify Sans" rel="stylesheet"></head><body id="container-box"><main><div class="container-box"><div class="header-container"><h2 class="title">Pomodoro Plant</h2><div class="shrink-close-icon"><img class="shrink-icon" src="assets/shrink-icon.png" alt="Shrink Icon"><img class="close-icon" src="assets/close-icon.png" alt="Close Icon"></div></div><div class="bottom-container" style="height: auto; min-height: 300px;"><h1 class="study-txt">My Garden</h1><p class="tap-txt" style="margin-bottom: 20px;">Unlocked: <span id="unlocked-count">0</span> / <span id="total-count">0</span></p><div class="plants-grid" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; width: 100%; max-height: 400px; overflow-y: auto; padding: 10px;"><!-- Plants will be loaded here via JS--></div><button class="enter-btn" id="menu-btn" style="margin-top: 20px; position: static;">Back to Menu</button></div></div></main><script src="js/config.js"></script><script src="js/lib/socket.io.js"></script><script src="js/socket-client.js"></script><script>document.getElementById('menu-btn').addEventListener('click', () => {
  window.location.href = 'menu.html';
});

async function loadPlants() {
  try {
    const token = localStorage.getItem('token');
    const response = await fetch(`${API_BASE_URL}/api/user/collection`, {
      headers: {
        'Authorization': token ? `Bearer ${token}` : ''
      }
    });
    
    if (!response.ok) {
      if (response.status === 401) {
        window.location.href = 'login.html';
        return;
      }
      throw new Error('Failed to load plants');
    }
    
    const data = await response.json();

    document.getElementById('unlocked-count').textContent = data.unlocked_count;
    document.getElementById('total-count').textContent = data.total_available;

    const grid = document.querySelector('.plants-grid');
    grid.innerHTML = '';

    // Create a map of unlocked plants for easy lookup
    const unlockedMap = new Map(data.plants.map(p => [p.id, p]));

    // Loop through all possible IDs (assuming 1 to total_available)
    for (let i = 1; i <= data.total_available; i++) {
        const plant = unlockedMap.get(i);
        const item = document.createElement('div');
        item.style.display = 'flex';
        item.style.flexDirection = 'column';
        item.style.alignItems = 'center';
        item.style.padding = '5px';
        item.style.border = '1px solid #ddd';
        item.style.borderRadius = '10px';
        item.style.background = '#fff';

        if (plant) {
            item.innerHTML = `
                <img src="assets/plant_stage_4/${plant.id}.svg" width="50" height="50">
                <span style="font-size: 10px; text-align: center; margin-top: 5px;">${plant.name}</span>
            `;
        } else {
            item.innerHTML = `
                <div style="width: 50px; height: 50px; background: #eee; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                    <span style="color: #aaa; font-size: 20px;">?</span>
                </div>
                <span style="font-size: 10px; text-align: center; margin-top: 5px; color: #aaa;">Locked</span>
            `;
        }
        grid.appendChild(item);
    }

  } catch (error) {
    console.error('Error loading plants:', error);
  }
}

loadPlants();</script></body></html>